<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>خدماتكم - لوحة المستخدم</title>
<style>
body { font-family: Arial, sans-serif; background-color: #f8fef8; margin:0; padding:0; }
header { background-color: #4CAF50; color: white; padding: 15px 0; text-align:center; font-size: 24px; }
.container { padding: 20px; max-width: 800px; margin:auto; }
.service-box { background:#fff; border:1px solid #ddd; border-radius:10px; text-align:center; padding:20px; margin-bottom:15px; cursor:pointer; }
.service-box:hover { background:#e8f5e9; }
input, select { padding:10px; margin:5px 0; width:100%; border-radius:5px; border:1px solid #ccc; }
button { padding:10px 20px; background:#4CAF50; color:white; border:none; border-radius:5px; cursor:pointer; }
button:hover { background:#45a049; }
.balance { font-weight:bold; margin-bottom:20px; }
</style>
</head>
<body>

<header>خدماتكم</header>
<div class="container">
  <?php
  session_start();
  // مثال: مستخدم مسجل دخوله
  if(!isset($_SESSION['user'])){
      $_SESSION['user'] = ['id'=>1,'username'=>'testuser','balance'=>50];
  }
  $user = $_SESSION['user'];
  ?>

  <div class="balance">رصيدك الحالي: <span id="user-balance"><?php echo $user['balance']; ?></span> $</div>

  <h2>اختر الخدمة المطلوبة</h2>

  <div class="service-box" onclick="selectService(1,'تيك توك',0.5)">خدمة تيك توك (0.5$/وحدة)</div>
  <div class="service-box" onclick="selectService(2,'انستغرام',0.7)">خدمة انستغرام (0.7$/وحدة)</div>
  <div class="service-box" onclick="selectService(3,'فيسبوك',0.4)">خدمة فيسبوك (0.4$/وحدة)</div>
  <div class="service-box" onclick="selectService(4,'شدات ببجي',1)">شدات ببجي (1$/وحدة)</div>

  <div id="order-form" style="display:none; margin-top:20px;">
    <h3>إرسال الطلب</h3>
    <p>الخدمة: <span id="service-name"></span></p>
    <p>السعر لكل وحدة: $<span id="service-price"></span></p>
    <label>الكمية:</label>
    <input type="number" id="quantity" min="1" value="1">
    <p>السعر الكلي: $<span id="total-price"></span></p>
    <button onclick="placeOrder()">إرسال الطلب</button>
    <p id="order-message" style="color:red;"></p>
  </div>

  <h2>شحن رصيد</h2>
  <label>المبلغ:</label>
  <input type="number" id="topup-amount" min="1" value="10">
  <button onclick="topUp()">شحن الرصيد</button>
</div>

<script>
let currentService = null;
function selectService(id,name,price){
  currentService = {id,name,price};
  document.getElementById('service-name').innerText = name;
  document.getElementById('service-price').innerText = price;
  document.getElementById('order-form').style.display='block';
  updateTotal();
}
function updateTotal(){
  let qty = document.getElementById('quantity').value;
  let total = qty * currentService.price;
  document.getElementById('total-price').innerText = total;
}
document.getElementById('quantity').addEventListener('input', updateTotal);

function placeOrder(){
  let qty = document.getElementById('quantity').value;
  let total = qty * currentService.price;
  let balance = parseFloat(document.getElementById('user-balance').innerText);
  let msg = document.getElementById('order-message');
  if(total > balance){
    msg.innerText = 'رصيدك غير كافي';
    return;
  }
  // خصم الرصيد (يمكن استبدالها بعملية AJAX إلى PHP)
  document.getElementById('user-balance').innerText = (balance - total).toFixed(2);
  msg.style.color='green';
  msg.innerText = 'تم إرسال الطلب!';
}

function topUp(){
  let amount = parseFloat(document.getElementById('topup-amount').value);
  let balance = parseFloat(document.getElementById('user-balance').innerText);
  document.getElementById('user-balance').innerText = (balance + amount).toFixed(2
